'From Cuis 4.0 of 16 November 2011 [latest update: #1144] on 6 December 2011 at 2:00:53 pm'!!FileDirectory methodsFor: 'file name utilities' stamp: 'jmv 12/6/2011 13:59'!                   lastNameFor: baseFileName extension: extension	"Assumes a file name includes a version number encoded as '.' followed by digits 	preceding the file extension.  Increment the version number and answer the new file name.	If a version number is not found, set the version to 1 and answer a new file name"	| files splits |	files _ self fileNamesMatching: (baseFileName,'*', self class dot, extension).	splits _ files collect: [:file | self splitNameVersionExtensionFor: file].	splits _ splits asArray sort: [:a :b | (a at: 2) < (b at: 2)].	^splits isEmpty 			ifTrue: [nil]			ifFalse: [((splits last at: 1), '.', (splits last at: 2) asString, self class dot, extension) asFileName]! !FileDirectory removeSelector: #lastNameFor:coda:extension:!