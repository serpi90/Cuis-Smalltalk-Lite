'From Cuis 3.0 of 18 January 2011 [latest update: #768] on 2 March 2011 at 6:03:44 pm'!!MessageNode methodsFor: 'private' stamp: 'ul 2/20/2011 17:17'!checkBlock: node as: nodeName from: encoder maxArgs: maxArgs	"Answer true if node is a BlockNode with at most maxArgs arguments.	This check is required in order to inline some special messages.	Notify some undue usage of these special messages."	node isBlockNode ifFalse: [ ^false ].	node numberOfArguments <= maxArgs ifTrue: [ ^true ].	^encoder notify: '<- ', nodeName , ' of ' , (MacroSelectors at: special) , ' has too many arguments'! !!MessageNode methodsFor: 'macro transformations' stamp: 'ul 2/26/2011 21:58'!transformCase: encoder	| caseNode |	caseNode := arguments first.	(caseNode isMemberOf: BraceNode) ifFalse: [ ^false ].	(caseNode blockAssociationCheck: encoder) ifFalse: [ ^false ].	(arguments size = 1 or: [		self checkBlock: arguments last as: 'otherwise arg' from: encoder ]) ifFalse: [			^false ].	 caseNode elements do: [ :messageNode |		messageNode receiver noteOptimizedIn: self.		messageNode arguments first noteOptimizedIn: self ].	 arguments size = 2 ifTrue: [ arguments last noteOptimizedIn: self ].	 ^true! !