'From Cuis 2.3 of 22 March 2010 [latest update: #472] on 29 March 2010 at 10:56:03 pm'!!CompiledMethod methodsFor: 'source code management' stamp: 'nice 11/7/2009 23:20'!destroySourcePointer	self sourcePointer = 0 ifFalse: [self setSourcePointer: 0]! !!SystemDictionary methodsFor: 'housekeeping' stamp: 'jmv 3/29/2010 22:55'!condenseChanges		"Move all the changes onto a compacted sources file."	"Smalltalk condenseChanges"	| f oldChanges classCount |	f _ FileStream fileNamed: 'ST80.temp'.	f timeStamp.'Condensing Changes File...'	displayProgressAt: Sensor cursorPoint	from: 0 to: Smalltalk classNames size	during:		[:bar | classCount _ 0.		Smalltalk allClassesDo:			[:class | bar value: (classCount _ classCount + 1).			class moveChangesTo: f.			class putClassCommentToCondensedChangesFile: f.			class class moveChangesTo: f]].	LastQuitLogPosition _ f position.	f close.	CompiledMethod allInstancesDo:		[ : e | 		e isInstalled ifFalse: [ e destroySourcePointer ] ].	oldChanges _ SourceFiles at: 2.	oldChanges close.	FileDirectory default 		deleteFileNamed: oldChanges name , '.old';		rename: oldChanges name toBe: oldChanges name , '.old';		rename: f name toBe: oldChanges name.	self setMacFileInfoOn: oldChanges name.	SourceFiles at: 2			put: (StandardFileStream oldFileNamed: oldChanges name).	self inform: 'Changes file has been rewritten!!Check that all is well, and then save/quit. Otherwise, remove new changes,replace it with the former one, andexit without saving the image. '! !!SystemDictionary methodsFor: 'housekeeping' stamp: 'jmv 3/29/2010 22:55'!condenseSources		"Move all the changes onto a compacted sources file."	"Smalltalk condenseSources"	| f classCount dir newVersionString newSourcesName |	dir _ FileDirectory default.	newVersionString _ FillInTheBlank request: 'Please designate the versionfor the new source code file...' initialAnswer: SourceFileVersionString.	newVersionString ifNil: [^ self].	newVersionString = SourceFileVersionString ifTrue:		[^ self error: 'The new source file must not be the same as the old.'].	SourceFileVersionString _ newVersionString.	"Write all sources with fileIndex 1"	newSourcesName _ self newSourcesName.	f _ FileStream newFileNamed: newSourcesName.	f timeStamp.'Condensing Sources File...'	displayProgressAt: Sensor cursorPoint	from: 0 to: Smalltalk classNames size	during:		[:bar | classCount _ 0.		Smalltalk allClassesDo:			[:class | bar value: (classCount _ classCount + 1).			class fileOutOn: f moveSource: true toFile: 1]].	f close.	CompiledMethod allInstancesDo:		[ : e | 		e isInstalled ifFalse: [ e destroySourcePointer ] ].	"Make a new empty changes file"	self closeSourceFiles.	dir rename: self localChangesName		toBe: self localChangesName , '.old'.	(FileStream newFileNamed: self localChangesName)		timeStamp; close.	LastQuitLogPosition _ 0.	self setMacFileInfoOn: self localChangesName.	self setMacFileInfoOn: newSourcesName.	self openSourceFiles.	self inform: 'Source files have been rewritten!! Check that all is well, and then save/quit. Otherwise, remove new sources/changes,replace them with the former ones, andexit without saving the image. '! !