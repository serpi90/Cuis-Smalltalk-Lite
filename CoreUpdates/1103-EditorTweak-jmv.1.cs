'From Cuis 3.3 of 2 June 2011 [latest update: #1024] on 7 October 2011 at 4:35:11 pm'!!TextEditor methodsFor: 'parenblinking' stamp: 'jmv 10/7/2011 16:35'!blinkPrevParen: aCharacter	"Used if not Shout"	| closingDelimiter openingDelimiter level string here hereChar |	string _ self privateCurrentString.	here _ pointBlock stringIndex.	closingDelimiter _ aCharacter.	openingDelimiter _ '([{' at: (')]}' indexOf: closingDelimiter).	level _ 1.	[ level > 0 and: [ here > 1 ]]		whileTrue: [			hereChar _ string at: (here _ here - 1).			hereChar = openingDelimiter				ifTrue: [					level _ level - 1.					level = 0						ifTrue: [^ self blinkParenAt: here]]				ifFalse: [					hereChar = closingDelimiter						ifTrue: [ level _ level + 1]]]! !!TextEditor methodsFor: 'typing support' stamp: 'jmv 10/7/2011 16:33'!dispatchOn: aKeyboardEvent	"Carry out the action associated with this character, if any."	| asciiValue c |	self clearParens.  	asciiValue _ aKeyboardEvent keyValue.	"Control keys are handled by KeystrokeActions even if they have any modifiers"	(asciiValue >= 32 and: [		aKeyboardEvent commandAltKeyPressed ]) ifTrue: [		^self perform: (self cmdActions at: asciiValue + 1) with: aKeyboardEvent ].	c _ aKeyboardEvent keyCharacter.	(')]}' includes: c)		ifTrue: [ self blinkPrevParen: c ].	^ self perform: (KeystrokeActions at: asciiValue + 1) with: aKeyboardEvent! !